"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[9107],{79107:function(e,n,t){t.r(n);var a=t(1413),s=t(74165),r=t(15861),c=t(70885),o=t(72791),i=t(83442),u=t(73560),l=t(43513),d=(t(64197),t(78983)),f=t(16871),p=t(80184),m=u.Z.afterToday;n.default=function(){var e=(0,f.TH)().state,n=o.useState([]),t=(0,c.Z)(n,2),_=t[0],g=t[1],h=o.useState(null),v=(0,c.Z)(h,2),y=v[0],b=v[1],Z=o.useState({per_page:100,page_number:1}),j=(0,c.Z)(Z,2),x=j[0],w=j[1],S=[{name:"Id",selector:function(e){return e.id},sortable:!0},{name:"IP Address",selector:function(e){return e.ip_address},sortable:!0},{name:"Location",selector:function(e){return e.location},sortable:!0},{name:"Resource/Access",selector:function(e){return e.page},sortable:!0},{name:"Visted At",selector:function(e){return new Date(e.created_at).toLocaleString()},sortable:!0}],N=o.useState(""),P=(0,c.Z)(N,2),k=P[0],O=P[1],C=o.useState(""),Q=(0,c.Z)(C,2),D=Q[0],R=Q[1],T=o.useState('Q(session_id="'.concat(e.session_id,'")')),E=(0,c.Z)(T,2),H=E[0],A=E[1];o.useEffect((function(){var e=i.ZP.accessDetails;(0,r.Z)((0,s.Z)().mark((function n(){var t,a;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(e,{method:"POST",headers:{Authorization:(0,i.kE)()},body:JSON.stringify({query:H})});case 2:return t=n.sent,n.next=5,t.json();case 5:a=n.sent,g(a.data),b(a.total);case 8:case"end":return n.stop()}}),n)})))()}),[H]);function L(){return L=(0,r.Z)((0,s.Z)().mark((function e(){var n,t,a,r,c,o,u,l,d,f;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.ZP.accessDetails,e.next=3,fetch(t+"?per_page=".concat(x.per_page,"&page_number=").concat(x.page_number),{method:"POST",headers:{Authorization:(0,i.kE)()},body:JSON.stringify({query:H})});case 3:return a=e.sent,r="data",c="traffic.csv",e.next=8,a.json();case 8:o=e.sent,(null===(n=o[r])||void 0===n?void 0:n.length)>=1&&(u="".concat(Object.keys(o[r][0]).map((function(e){return'"'.concat(e,'"')})).join(","),"\n"),l="",o[r].forEach((function(e){l+="".concat(Object.values(e).map((function(e){return'"'.concat("object"===typeof e?"":e,'"')})).join(","),"\n")})),d=URL.createObjectURL(new Blob([u+l],{type:"text/csv"})),(f=document.createElement("a")).href=d,f.download=c,f.click());case 10:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.xH,{className:"my-2",children:(0,p.jsx)(d.sl,{children:(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-4",children:(0,p.jsx)(u.Z,{className:"w-100",placeholder:"Entering Time Range",format:"yyyy-MM-dd HH:mm:ss",disabledDate:m(),onChange:function(e){var n;return O(null!==(n=JSON.stringify(null===e||void 0===e?void 0:e.map((function(e){return new Date(e).toISOString()}))))&&void 0!==n?n:"")}})}),(0,p.jsx)("div",{className:"col-4",children:(0,p.jsx)(u.Z,{className:"w-100",placeholder:"Leaving Time Range",format:"yyyy-MM-dd HH:mm:ss",disabledDate:m(),onChange:function(e){var n;return R(null!==(n=JSON.stringify(null===e||void 0===e?void 0:e.map((function(e){return new Date(e).toISOString()}))))&&void 0!==n?n:"")}})}),(0,p.jsx)("div",{className:"col-2",children:(0,p.jsx)(d.u5,{type:"button",className:"float-end w-100",color:"primary",onClick:function(){A(k&&D?'Q(session_id="'.concat(e.session_id,'") & Q(created_at__range=').concat(k,") & Q(closed_at__range=").concat(D,")"):k?'Q(session_id="'.concat(e.session_id,'") & Q(created_at__range=').concat(k,")"):D?'Q(session_id="'.concat(e.session_id,'") & Q(closed_at__range=').concat(D,")"):'Q(session_id="'.concat(e.session_id,'")'))},children:"Search"})}),(0,p.jsx)("div",{className:"col-2",children:(0,p.jsx)(d.u5,{type:"button",className:"float-end w-100",color:"success",onClick:function(){return L.apply(this,arguments)},children:"Download CSV"})})]})})}),(0,p.jsx)(l.ZP,{columns:S,data:_,pagination:!0,paginationServer:!0,paginationPerPage:100,paginationRowsPerPageOptions:[100,50,30],paginationTotalRows:y,onChangeRowsPerPage:function(e){return w((0,a.Z)((0,a.Z)({},x),{},{per_page:e}))},onChangePage:function(e,n){return w((0,a.Z)((0,a.Z)({},x),{},{page_number:e}))}})]})}}}]);
//# sourceMappingURL=9107.94f9320e.chunk.js.map