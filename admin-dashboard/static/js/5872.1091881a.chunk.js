"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[5872],{15872:function(e,n,t){t.r(n);var a=t(1413),s=t(74165),r=t(15861),o=t(70885),c=t(72791),i=t(43513),l=t(83442),d=t(9085),u=t(78983),m=t(80184),p=function(e){var n='"Crossing Name","Crossing Address","Closed/Caution on","Status Changed By","Opened On","Opened By"\n';return e.forEach((function(e){var t;n+='"'.concat(e.crossing.name,'","').concat(e.crossing.address,'","').concat(new Date(e.created_at).toLocaleString(),'","').concat(e.user.name,'","').concat(null!==e&&void 0!==e&&e.opened_at?new Date(null===e||void 0===e?void 0:e.opened_at).toLocaleString():"",'","').concat((null===(t=e.opened_by)||void 0===t?void 0:t.name)||"",'"\n')})),n};n.default=function(){var e=c.useState({start:"",end:""}),n=(0,o.Z)(e,2),t=n[0],h=n[1],g=c.useState({}),f=(0,o.Z)(g,2),x=f[0],v=f[1],_=c.useState({per_page:100,page_number:1}),j=(0,o.Z)(_,2),b=j[0],y=j[1],w=c.useState(0),S=(0,o.Z)(w,2),C=S[0],N=S[1],O=[{name:"Crossing Name",selector:function(e){return e.crossing.name},sortable:!0},{name:"Crossing Address",selector:function(e){return e.crossing.address},sortable:!0},{name:"Closed/Caution On",selector:function(e){return new Date(e.updated_at).toLocaleString()},sortable:!0},{name:"Status Changed By",selector:function(e){var n,t;return null!==(n=null===(t=e.user)||void 0===t?void 0:t.name)&&void 0!==n?n:"ATX Admin"},sortable:!0},{name:"Opened on",selector:function(e){return e.opened_at?new Date(e.opened_at).toLocaleString():""},sortable:!0},{name:"Opened by",selector:function(e){var n,t;return null!==(n=null===(t=e.opened_by)||void 0===t?void 0:t.name)&&void 0!==n?n:"ATX Admin"},sortable:!0}],Z=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var n,a,r,o,c,i,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.ZP.crossingsHistory,e.next=3,fetch(n+"?per_page=".concat(-1),{method:"POST",headers:{Authorization:(0,l.kE)()},body:JSON.stringify(t)});case 3:return a=e.sent,e.next=6,a.json();case 6:r=e.sent,o=p(r.data),c=new Blob([o],{type:"text/csv"}),i=URL.createObjectURL(c),(d=document.createElement("a")).href=i,d.download="closurehistory.csv",document.body.appendChild(d),d.click();case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.useEffect((function(){var e=l.ZP.crossingsHistory;(0,r.Z)((0,s.Z)().mark((function n(){var a,r;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(e+"?per_page=".concat(b.per_page,"&page_number=").concat(b.page_number),{method:"POST",headers:{Authorization:(0,l.kE)()},body:JSON.stringify(t)});case 2:return a=n.sent,n.next=5,a.json();case 5:r=n.sent,v(r.data),N(r.total);case 8:case"end":return n.stop()}}),n)})))()}),[b,t]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.Ix,{position:"top-right",theme:"colored",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,className:"history-table",closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),(0,m.jsx)(u.xH,{className:"my-2",children:(0,m.jsx)(u.sl,{children:(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-md-6",children:(0,m.jsx)("h5",{className:"d-inline text-uppercase",children:"Crossing Closures History"})})})})}),(0,m.jsx)(u.xH,{className:"my-2",children:(0,m.jsx)(u.sl,{children:(0,m.jsxs)("form",{className:"row",onSubmit:function(e){e.preventDefault();var n=new FormData(e.target),t=new Date(n.get("start")).toISOString(),a=new Date(n.get("end")).toISOString();h({start:t,end:a})},children:[(0,m.jsxs)("div",{className:"col-4",children:[(0,m.jsx)(u.L8,{children:"Start DateTime"}),(0,m.jsx)(u.jO,{type:"datetime-local",className:"search-text",name:"start"})]}),(0,m.jsxs)("div",{className:"col-4",children:[(0,m.jsx)(u.L8,{children:"End DateTime"}),(0,m.jsx)(u.jO,{type:"datetime-local",className:"search-text",name:"end"})]}),(0,m.jsxs)("div",{className:"col-2",children:[(0,m.jsx)(u.L8,{children:"\xa0"}),(0,m.jsx)(u.u5,{type:"submit",className:"float-end w-100",color:"primary",children:"Search"})]}),(0,m.jsxs)("div",{className:"col-2",children:[(0,m.jsx)(u.L8,{children:"\xa0"}),(0,m.jsx)(u.u5,{type:"button",className:"float-end w-100",onClick:Z,color:"success",children:"Download"})]})]})})}),(0,m.jsx)(i.ZP,{columns:O,data:x,className:"history-table",paginationPerPage:100,paginationRowsPerPageOptions:[100,50,30],pagination:!0,paginationServer:!0,paginationTotalRows:C,onChangeRowsPerPage:function(e){return y((0,a.Z)((0,a.Z)({},b),{},{per_page:e}))},onChangePage:function(e,n){return y((0,a.Z)((0,a.Z)({},b),{},{page_number:e}))}})]})}}}]);
//# sourceMappingURL=5872.1091881a.chunk.js.map